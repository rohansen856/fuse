package controllers

import (
	"context"
	"github.com/ritankarsaha/backend/database"
	"github.com/ritankarsaha/backend/models"
	"net/http"
	"time"
	"github.com/gin-gonic/gin"
	"go.mongodb.org/mongo-driver/bson"
	"go.mongodb.org/mongo-driver/bson/primitive"
	"go.mongodb.org/mongo-driver/mongo"
)

var newsCollection *mongo.Collection = database.OpenCollection(database.Client, "news")
func CreateNews(c *gin.Context) {
	var input models.News

	if err := c.ShouldBindJSON(&input); err != nil {
		c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
		return
	}

	if input.Category == "" {
		input.Category = "General"
	}
	if input.Datetime.IsZero() {
		input.Datetime = time.Now()
	}
	if input.Headline == "" {
		input.Headline = "News"
	}
	if input.Image == "" {
		input.Image = "data:image/jpeg;base64,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"
	}
	if input.Related == "" {
		input.Related = "None"
	}
	if input.Source == "" {
		input.Source = "Unknown"
	}
	if input.Summary == "" {
		input.Summary = "No summary available."
	}
	if input.URL == "" {
		input.URL = "data:image/jpeg;base64,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"
	}

	result, err := newsCollection.InsertOne(context.TODO(), input)
	if err != nil {
		c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
		return
	}

	c.JSON(http.StatusOK, gin.H{"message": "News created successfully", "news_id": result.InsertedID})
}


func GetNews(c *gin.Context) {
	ctx, cancel := context.WithTimeout(context.Background(), 100*time.Second)
		defer cancel()

		var newsList []models.News

		cursor, err := newsCollection.Find(ctx, bson.M{})
		if err != nil {
			c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
			return
		}
		defer cursor.Close(ctx)

		for cursor.Next(ctx) {
			var news models.News
			if err := cursor.Decode(&news); err != nil {
				c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
				return
			}
			newsList = append(newsList, news)
		}

		if err := cursor.Err(); err != nil {
			c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
			return
		}

		c.JSON(http.StatusOK, gin.H{"allNews": newsList})
}







func GetNewsByID(c *gin.Context) {
	ctx, cancel := context.WithTimeout(context.Background(), 100*time.Second)
	defer cancel()

	newsID := c.Param("id")

	objectID, err := primitive.ObjectIDFromHex(newsID)
	if err != nil {
		c.JSON(http.StatusBadRequest, gin.H{"error": "Invalid ID format"})
		return
	}

	var news models.News

	err = newsCollection.FindOne(ctx, bson.M{"_id": objectID}).Decode(&news)
	if err != nil {
		if err == mongo.ErrNoDocuments {
			c.JSON(http.StatusNotFound, gin.H{"error": "News not found"})
			return
		}
		c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
		return
	}

	c.JSON(http.StatusOK, news)
}

func UpdateNews(c *gin.Context) {
	ctx, cancel := context.WithTimeout(context.Background(), 100*time.Second)
	defer cancel()

	newsID := c.Param("id")

	objectID, err := primitive.ObjectIDFromHex(newsID)
	if err != nil {
		c.JSON(http.StatusBadRequest, gin.H{"error": "Invalid ID format"})
		return
	}

	var updatedNews models.News

	if err := c.ShouldBindJSON(&updatedNews); err != nil {
		c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
		return
	}

	filter := bson.M{"_id": objectID}
	update := bson.M{"$set": updatedNews}

	result, err := newsCollection.UpdateOne(ctx, filter, update)
	if err != nil {
		c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
		return
	}

	if result.MatchedCount == 0 {
		c.JSON(http.StatusNotFound, gin.H{"error": "News not found"})
		return
	}

	c.JSON(http.StatusOK, gin.H{"message": "News updated successfully"})
}


func DeleteNews(c *gin.Context) {
	ctx, cancel := context.WithTimeout(context.Background(), 100*time.Second)
	defer cancel()

	newsID := c.Param("id")

	objectID, err := primitive.ObjectIDFromHex(newsID)
	if err != nil {
		c.JSON(http.StatusBadRequest, gin.H{"error": "Invalid ID format"})
		return
	}

	filter := bson.M{"_id": objectID}
	result, err := newsCollection.DeleteOne(ctx, filter)
	if err != nil {
		c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
		return
	}

	if result.DeletedCount == 0 {
		c.JSON(http.StatusNotFound, gin.H{"error": "News not found"})
		return
	}

	c.JSON(http.StatusOK, gin.H{"message": "News deleted successfully"})
}
func GetNewsByCategory(c *gin.Context){
	ctx, cancel := context.WithTimeout(context.Background(), 100*time.Second)
	defer cancel()
	category := c.Param("category")

	filter := bson.M{"category": category}

		
		var newsItems []models.News
		cursor, err := newsCollection.Find(ctx, filter)
		if err != nil {
			c.JSON(http.StatusInternalServerError, gin.H{"error": "Error finding news items"})
			return
		}
		defer cursor.Close(ctx)

		for cursor.Next(ctx) {
			var newsItem models.News
			if err = cursor.Decode(&newsItem); err != nil {
				c.JSON(http.StatusInternalServerError, gin.H{"error": "Error decoding news item"})
				return
			}
			newsItems = append(newsItems, newsItem)
		}

		if err := cursor.Err(); err != nil {
			c.JSON(http.StatusInternalServerError, gin.H{"error": "Error iterating through news items"})
			return
		}

		c.JSON(http.StatusOK, newsItems)

}
